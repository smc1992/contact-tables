(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9635],{95443:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var r=t(92401),s=t(41664),a=t.n(s),i=t(11163),l=t(89681),o=t(91472),c=t(5802);function d(e){var n=e.activeItem,t=void 0===n?"dashboard":n,s=(0,i.useRouter)(),d=(0,r.useState)(!1),u=d[0],m=d[1],x=[{icon:o.m6D,label:"Dashboard",id:"dashboard",path:"/admin/dashboard"},{icon:o.LSm,label:"Partneranfragen",id:"partner-requests",path:"/admin/partner-requests"},{icon:o.SnF,label:"Restaurants",id:"restaurants",path:"/admin/restaurants"},{icon:o.orK,label:"Kontakttisch-Analysen",id:"contact-tables-analytics",path:"/admin/contact-tables/analytics"},{icon:o.bfl,label:"Moderation",id:"moderation",path:"/admin/moderation/reviews"},{icon:o.zFh,label:"Abonnements",id:"subscriptions",path:"/admin/subscriptions"},{icon:o.aCJ,label:"Kategorien",id:"categories",path:"/admin/categories"},{icon:o.E25,label:"Ausstattung",id:"amenities",path:"/admin/amenities"},{icon:o.i63,label:"St\xe4dte",id:"cities",path:"/admin/cities"},{icon:o.WY8,label:"Benutzer",id:"users",path:"/admin/users",useRouterPush:!0},{icon:o.NOg,label:"Blogs",id:"blogs",path:"/admin/blogs"},{icon:o.Imn,label:"Newsletter",id:"newsletter",path:"/admin/newsletters"},{icon:o.Imn,label:"E-Mail-Builder",id:"email-builder",path:"/admin/email-builder"},{icon:o.nbt,label:"Einstellungen",id:"settings",path:"/admin/settings"}];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"fixed bottom-4 right-4 md:hidden z-30",children:(0,c.jsx)("button",{onClick:function(){return m(!u)},className:"bg-primary-600 text-white p-3 rounded-full shadow-lg",children:u?(0,c.jsx)(o.q5L,{size:24}):(0,c.jsx)(o.cur,{size:24})})}),(0,c.jsx)(l.E.div,{className:"fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden",initial:{opacity:0},animate:{opacity:u?1:0},transition:{duration:.2},style:{pointerEvents:u?"auto":"none"},children:(0,c.jsxs)(l.E.div,{className:"fixed inset-y-0 left-0 w-64 bg-white shadow-xl z-30 overflow-y-auto",initial:{x:"-100%"},animate:{x:u?0:"-100%"},transition:{duration:.3},children:[(0,c.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Admin"}),(0,c.jsx)("button",{onClick:function(){return m(!1)},className:"text-gray-500 hover:text-gray-700",children:(0,c.jsx)(o.q5L,{size:24})})]})}),(0,c.jsx)("nav",{className:"p-4",children:(0,c.jsx)("ul",{className:"space-y-2",children:x.map(function(e){var n=e.icon,r=t===e.id;return(0,c.jsx)("li",{children:e.useRouterPush?(0,c.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors cursor-pointer ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Mobile): Router.push zu ".concat(e.label," (").concat(e.path,")")),s.push(e.path),m(!1)},children:[(0,c.jsx)(n,{size:20}),(0,c.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,c.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]}):(0,c.jsxs)(a(),{href:e.path,className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Mobile): Link zu ".concat(e.label," (").concat(e.path,") geklickt")),m(!1)},children:[(0,c.jsx)(n,{size:20}),(0,c.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,c.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]})},e.id)})})})]})}),(0,c.jsx)("aside",{className:"hidden md:block w-64 bg-white shadow-md min-h-screen pt-20",children:(0,c.jsx)("nav",{className:"p-4",children:(0,c.jsx)("ul",{className:"space-y-2",children:x.map(function(e){var n=e.icon,r=t===e.id;return(0,c.jsx)("li",{children:e.useRouterPush?(0,c.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors cursor-pointer ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Desktop): Router.push zu ".concat(e.label," (").concat(e.path,")")),s.push(e.path)},children:[(0,c.jsx)(n,{size:20}),(0,c.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,c.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]}):(0,c.jsxs)(a(),{href:e.path,className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Desktop): Link zu ".concat(e.label," (").concat(e.path,") geklickt"))},children:[(0,c.jsx)(n,{size:20}),(0,c.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,c.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]})},e.id)})})})})]})}},17662:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var r=t(41664),s=t.n(r),a=t(25675),i=t.n(a),l=t(91472),o=t(41338),c=t(5802);function d(){return(0,c.jsx)("footer",{className:"bg-gradient-to-br from-neutral-900 to-neutral-800 text-neutral-300",children:(0,c.jsxs)("div",{className:"container mx-auto py-16 px-4",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-12",children:[(0,c.jsxs)("div",{className:"space-y-6",children:[(0,c.jsx)(s(),{href:"/",className:"inline-block",children:(0,c.jsx)("div",{className:"flex items-center space-x-3 group",children:(0,c.jsx)("div",{className:"h-12 bg-white p-2 rounded-lg overflow-hidden relative",children:(0,c.jsx)(i(),{src:"/images/logo-fixed/Logo CT quer 4c.webp",alt:"Contact Tables Logo",width:120,height:40,className:"transition-all group-hover:scale-105",priority:!0,style:{objectFit:"contain",width:"auto",height:"100%"},quality:100})})})}),(0,c.jsx)("p",{className:"text-neutral-400 leading-relaxed",children:"Wir verbinden Menschen am Restauranttisch â€“ f\xfcr echte Begegnungen und inspirierende Gespr\xe4che."})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-xl font-semibold text-white mb-6 border-b border-neutral-700 pb-3",children:"Entdecken"}),(0,c.jsxs)("ul",{className:"space-y-4",children:[(0,c.jsx)("li",{children:(0,c.jsxs)(s(),{href:"/restaurants",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,c.jsx)(l.i63,{className:"group-hover:translate-x-1 transition-transform"}),(0,c.jsx)("span",{children:"Restaurants finden"})]})}),(0,c.jsx)("li",{children:(0,c.jsxs)(s(),{href:"/about",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,c.jsx)(l.WY8,{className:"group-hover:translate-x-1 transition-transform"}),(0,c.jsx)("span",{children:"\xdcber uns"})]})}),(0,c.jsx)("li",{children:(0,c.jsxs)(s(),{href:"/restaurant/register",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,c.jsx)(l.i63,{className:"group-hover:translate-x-1 transition-transform"}),(0,c.jsx)("span",{children:"Restaurant anmelden"})]})}),(0,c.jsx)("li",{children:(0,c.jsxs)(s(),{href:"/events",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,c.jsx)(l.TCC,{className:"group-hover:translate-x-1 transition-transform"}),(0,c.jsx)("span",{children:"Events & Aktionen"})]})})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-xl font-semibold text-white mb-6 border-b border-neutral-700 pb-3",children:"Rechtliches"}),(0,c.jsxs)("ul",{className:"space-y-4",children:[(0,c.jsx)("li",{children:(0,c.jsx)(s(),{href:"/datenschutz",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"Datenschutzerkl\xe4rung"})}),(0,c.jsx)("li",{children:(0,c.jsx)(s(),{href:"/faq",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"FAQ"})}),(0,c.jsx)("li",{children:(0,c.jsx)(s(),{href:"/impressum",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"Impressum"})}),(0,c.jsx)("li",{children:(0,c.jsx)(s(),{href:"/barrierefreiheit",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"Barrierefreiheit"})})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h4",{className:"text-xl font-semibold text-white mb-6 border-b border-neutral-700 pb-3",children:"Kontakt"}),(0,c.jsxs)("ul",{className:"space-y-4",children:[(0,c.jsx)("li",{className:"group",children:(0,c.jsxs)("a",{href:"tel:+4915679640069",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,c.jsx)(l.tUt,{size:16})}),(0,c.jsx)("span",{children:"+49 15679 640069"})]})}),(0,c.jsx)("li",{className:"group",children:(0,c.jsxs)(s(),{href:"/contact",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,c.jsx)(l.Imn,{size:16})}),(0,c.jsx)("span",{children:"Nachricht absenden"})]})}),(0,c.jsx)("li",{className:"group",children:(0,c.jsxs)("a",{href:"https://www.facebook.com/contacttables/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,c.jsx)(o.tBk,{size:16})}),(0,c.jsx)("span",{children:"Facebook"})]})}),(0,c.jsx)("li",{className:"group",children:(0,c.jsxs)("a",{href:"https://www.instagram.com/contacttables/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,c.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,c.jsx)(o.Zf_,{size:16})}),(0,c.jsx)("span",{children:"Instagram"})]})})]})]})]}),(0,c.jsx)("div",{className:"border-t border-neutral-800 mt-16 pt-8 text-center",children:(0,c.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[(0,c.jsxs)("p",{className:"text-neutral-500",children:["\xa9 ",new Date().getFullYear()," contact-tables. Alle Rechte vorbehalten."]}),(0,c.jsxs)("p",{className:"flex items-center text-neutral-500",children:[(0,c.jsx)("span",{children:"Made with"})," ",(0,c.jsx)(l.$aX,{className:"mx-2 text-primary-500"})," ",(0,c.jsx)("span",{children:"in Germany"})]})]})})]})})}},70063:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(92401),s=t(91472),a=t(5802);function i(e){var n=e.id,t=e.name,i=e.placeholder,l=e.value,o=e.onChange,c=e.required,d=e.className,u=e.autoComplete,m=e.disabled,x=e.minLength,h=(0,r.useState)(!1),g=h[0],p=h[1],f=(0,r.useState)(!1),b=f[0],j=f[1],v=(0,r.useRef)(null);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{ref:v,type:g?"text":"password",id:n,name:t,placeholder:void 0===i?"Passwort eingeben":i,value:l,onChange:o,onFocus:function(){j(!0)},onBlur:function(){j(!1)},required:void 0!==c&&c,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ".concat(void 0===d?"":d),autoComplete:void 0===u?"current-password":u,disabled:void 0!==m&&m,minLength:x}),(0,a.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),p(!g),v.current&&v.current.focus()},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none ".concat(b?"z-10":""),"aria-label":g?"Passwort verbergen":"Passwort anzeigen",tabIndex:-1,children:g?(0,a.jsx)(s.rzC,{size:20}):(0,a.jsx)(s.rDJ,{size:20})})]})}},86553:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return O},config:function(){return L},default:function(){return M}});var r=t(90116),s=t(17674),a=t(59499),i=t(50029),l=t(64687),o=t.n(l),c=t(92401),d=t(11163),u=t(65289),m=t(63708),x=t(17662),h=t(95443),g=t(91472),p=t(41338),f=t(70063),b=t(86561),j=t(38342),v=t(68134),y=t(2370),w=t(18565),N=t(34743),k=t(30262),_=t(15684),Z=t(4229),S=t(63737),z=t(23439),T=t(33646),C=t(64338),P=t(90418),F=t(73350),B=t(5802);function E(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function A(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?E(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var O=!0,L={unstable_runtimeJS:!0,runtime:"nodejs"};function M(e){var n,t,l,E,O,L,M,I,R,U,D,q,K,V,J=e.initialUsers,W=e.initialGroupedUsers,X=e.error,G=e.user,Q=(0,d.useRouter)(),Y=(0,u.useAuth)(),$=Y.session,H=Y.user,ee=Y.loading,en=(0,c.useState)(J||[]),et=en[0],er=en[1],es=(0,c.useState)(W||{admin:[],restaurant:[],customer:[],user:[]}),ea=es[0],ei=es[1],el=(0,c.useState)("all"),eo=el[0],ec=el[1],ed=(0,c.useState)(!1),eu=ed[0],em=ed[1],ex=(0,c.useState)(!1),eh=ex[0],eg=ex[1],ep=(0,c.useState)(!1),ef=ep[0],eb=ep[1],ej=(0,c.useState)(!1),ev=ej[0],ey=ej[1],ew=(0,c.useState)(null),eN=ew[0],ek=ew[1],e_=(0,c.useState)({email:"",role:"user",first_name:"",last_name:"",phone:"",password:"",is_active:!0,restaurant_name:"",restaurant_isVisible:!1,admin_canManageUsers:!1,admin_canManageSettings:!1}),eZ=e_[0],eS=e_[1],ez=(0,c.useState)({password:"",confirmPassword:""}),eT=ez[0],eC=ez[1],eP=(0,c.useState)(""),eF=eP[0],eB=eP[1],eE=(0,c.useState)(""),eA=eE[0],eO=eE[1],eL=(0,c.useState)("all"),eM=eL[0],eI=eL[1],eR=(0,c.useState)(!1),eU=eR[0],eD=eR[1],eq=(0,c.useState)("all"),eK=eq[0],eV=eq[1],eJ=(0,c.useState)(!1),eW=eJ[0],eX=eJ[1],eG=(0,c.useState)([]),eQ=eG[0],eY=eG[1],e$=(0,c.useState)(10),eH=e$[0],e0=e$[1],e1=(0,c.useState)(1),e2=e1[0],e3=e1[1];(0,c.useEffect)(function(){var e;console.log("Benutzerseite geladen"),console.log("Router-Pfad:",Q.pathname),console.log("Router-Query:",Q.query),console.log("Benutzer authentifiziert:",!!$),console.log("Benutzerrolle:",null==H||null===(e=H.user_metadata)||void 0===e?void 0:e.role),X&&console.error("Fehler aus getServerSideProps:",X)},[Q,$,H,X]);var e4=(n=(0,i.Z)(o().mark(function e(){var n,t,r,a,i,l,c,d,u,m,x;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return eg(!0),e.prev=1,console.log("Rufe API-Route /api/admin/users auf..."),e.next=5,fetch("/api/admin/users");case 5:return i=e.sent,e.next=8,i.json();case 8:if(!(l=e.sent).error){e.next=13;break}return console.error("Fehler beim Laden der Benutzer:",l.error),b.ZP.error("Fehler beim Laden der Benutzer"),e.abrupt("return");case 13:if(Array.isArray(l.users)){e.next=16;break}throw console.error("Unerwartetes API-Antwortformat:",l),Error("Unerwartetes API-Antwortformat");case 16:return console.log("Lade Benutzer-Tags..."),e.next=19,fetch("/api/admin/users/get-user-tags");case 19:return c=e.sent,e.next=22,c.json();case 22:(d=e.sent).error&&console.error("Fehler beim Laden der Benutzer-Tags:",d.error),u=d.userTags||{},m=l.users.map(function(e){return A(A({},e),{},{tags:u[e.id]||[]})}),x={},Object.entries(l.groupedUsers||{}).forEach(function(e){var n=(0,s.Z)(e,2),t=n[0],r=n[1];x[t]=r.map(function(e){return A(A({},e),{},{tags:u[e.id]||[]})})}),er(m),ei(x||{admin:[],restaurant:[],customer:[],user:[]}),console.log("Geladene Benutzer:",m.length),console.log("Benutzer nach Rollen:",{admin:(null==x||null===(n=x.admin)||void 0===n?void 0:n.length)||0,restaurant:(null==x||null===(t=x.restaurant)||void 0===t?void 0:t.length)||0,customer:(null==x||null===(r=x.customer)||void 0===r?void 0:r.length)||0,user:(null==x||null===(a=x.user)||void 0===a?void 0:a.length)||0}),e.next=39;break;case 34:e.prev=34,e.t0=e.catch(1),console.error("Fehler beim Laden der Benutzer:",e.t0),b.ZP.error("Fehler beim Laden der Benutzer: ".concat(e.t0 instanceof Error?e.t0.message:"Unbekannter Fehler")),er([{id:"1",email:"admin@contact-tables.org",role:"admin",first_name:"Admin",last_name:"User",phone:"+49123456789",created_at:"2025-01-15T12:00:00Z",last_sign_in_at:"2025-08-20T10:30:00Z",is_active:!0,tags:[]},{id:"2",email:"restaurant@example.com",role:"restaurant",first_name:"Restaurant",last_name:"Owner",phone:"+49987654321",created_at:"2025-02-10T09:45:00Z",last_sign_in_at:"2025-08-19T14:20:00Z",is_active:!0,tags:[]},{id:"3",email:"customer@example.com",role:"customer",first_name:"Max",last_name:"Mustermann",phone:"+49123123123",created_at:"2025-03-05T15:30:00Z",last_sign_in_at:"2025-08-18T18:15:00Z",is_active:!0,tags:[]}]);case 39:return e.prev=39,em(!1),eg(!1),e.finish(39);case 43:case"end":return e.stop()}},e,null,[[1,34,39,43]])})),function(){return n.apply(this,arguments)});(0,c.useEffect)(function(){e4(),nF()},[]),(0,c.useEffect)(function(){ee||0!==J.length||e4(),nF(),G&&console.log("Authentifizierter Benutzer:",G.email)},[ee,J.length,G]);var e5=function(e){if(!e)return"-";var n=new Date(e);return n.toLocaleDateString("de-DE")+" "+n.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})},e6=function(e){var n=e.target,t=n.name,r=n.value,s=n.type;eS(function(n){return A(A({},n),{},(0,a.Z)({},t,"checkbox"===s?e.target.checked:r))})},e7=function(e){var n=e.target,t=n.name,r=n.value;eC(function(e){return A(A({},e),{},(0,a.Z)({},t,r))})},e8=(t=(0,i.Z)(o().mark(function e(n){var t,r,s,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ek(n),eS({email:n.email,role:n.role,first_name:n.first_name||"",last_name:n.last_name||"",phone:n.phone||"",password:"",is_active:n.is_active,restaurant_name:"",restaurant_isVisible:!1,admin_canManageUsers:!1,admin_canManageSettings:!1}),e.prev=2,e.next=5,fetch("/api/admin/users/".concat(n.id));case 5:if(!(t=e.sent).ok){e.next=13;break}return e.next=9,t.json();case 9:s=null==(r=e.sent)?void 0:r.restaurant,a=null==r?void 0:r.admin,eS(function(e){return A(A({},e),{},{restaurant_name:(null==s?void 0:s.name)||"",restaurant_isVisible:!!(null!=s&&s.isVisible),admin_canManageUsers:!!(null!=a&&a.canManageUsers),admin_canManageSettings:!!(null!=a&&a.canManageSettings)})});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),console.error("Fehler beim Laden der Benutzerdetails:",e.t0);case 18:eb(!0);case 19:case"end":return e.stop()}},e,null,[[2,15]])})),function(e){return t.apply(this,arguments)}),e9=function(){e4()},ne=function(e){ek(e),eC({password:"",confirmPassword:""}),ey(!0)},nn=(l=(0,i.Z)(o().mark(function e(n){var t,r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),e.prev=1,!eN){e.next=14;break}return e.next=5,fetch("/api/admin/users/".concat(eN.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:eZ.role,first_name:eZ.first_name,last_name:eZ.last_name,phone:eZ.phone,is_active:eZ.is_active,restaurant_name:eZ.restaurant_name,restaurant_isVisible:eZ.restaurant_isVisible,admin_canManageUsers:eZ.admin_canManageUsers,admin_canManageSettings:eZ.admin_canManageSettings})});case 5:if((t=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,t.text();case 10:throw e.t1=e.sent,new e.t0(e.t1);case 12:e.next=26;break;case 14:if(eZ.password){e.next=17;break}return alert("Bitte geben Sie ein Passwort ein"),e.abrupt("return");case 17:return e.next=19,fetch("/api/admin/users/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:eZ.email,password:eZ.password,role:eZ.role,first_name:eZ.first_name,last_name:eZ.last_name,phone:eZ.phone,restaurant_name:eZ.restaurant_name,restaurant_isVisible:eZ.restaurant_isVisible,admin_canManageUsers:eZ.admin_canManageUsers,admin_canManageSettings:eZ.admin_canManageSettings})});case 19:if((r=e.sent).ok){e.next=26;break}return e.t2=Error,e.next=24,r.text();case 24:throw e.t3=e.sent,new e.t2(e.t3);case 26:eb(!1),e9(),e.next=34;break;case 30:e.prev=30,e.t4=e.catch(1),console.error("Fehler beim Speichern des Benutzers:",e.t4),alert("Fehler beim Speichern des Benutzers");case 34:case"end":return e.stop()}},e,null,[[1,30]])})),function(e){return l.apply(this,arguments)}),nt=(E=(0,i.Z)(o().mark(function e(n){var t;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),eN){e.next=3;break}return e.abrupt("return");case 3:if(!(eT.password!==eT.confirmPassword)){e.next=6;break}return alert("Die Passw\xf6rter stimmen nicht \xfcberein"),e.abrupt("return");case 6:return e.prev=6,e.next=9,fetch("/api/admin/users/".concat(eN.id,"/password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:eT.password})});case 9:if((t=e.sent).ok){e.next=16;break}return e.t0=Error,e.next=14,t.text();case 14:throw e.t1=e.sent,new e.t0(e.t1);case 16:ey(!1),alert("Passwort erfolgreich ge\xe4ndert"),e.next=24;break;case 20:e.prev=20,e.t2=e.catch(6),console.error("Fehler beim \xc4ndern des Passworts:",e.t2),alert("Fehler beim \xc4ndern des Passworts");case 24:case"end":return e.stop()}},e,null,[[6,20]])})),function(e){return E.apply(this,arguments)}),nr=(O=(0,i.Z)(o().mark(function e(n){var t,r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="string"==typeof n?n:n.id,confirm("M\xf6chten Sie diesen Benutzer wirklich l\xf6schen?")){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch("/api/admin/users/".concat(t),{method:"DELETE"});case 6:if((r=e.sent).ok){e.next=13;break}return e.t0=Error,e.next=11,r.text();case 11:throw e.t1=e.sent,new e.t0(e.t1);case 13:e9(),e.next=20;break;case 16:e.prev=16,e.t2=e.catch(3),console.error("Fehler beim L\xf6schen des Benutzers:",e.t2),alert("Fehler beim L\xf6schen des Benutzers");case 20:case"end":return e.stop()}},e,null,[[3,16]])})),function(e){return O.apply(this,arguments)}),ns="all"===eo?et:ea[eo]||[],na=(ns||[]).filter(function(e){if("active"===eM&&!e.is_active||"inactive"===eM&&e.is_active||eU&&!e.phone||"all"!==eK&&(eQ.length>0&&!eQ.includes(e.id)||0===eQ.length&&"none"!==eK||"none"===eK&&0===eQ.length))return!1;var n=eF.trim().toLowerCase();if(n){var t=((e.name||"").toString()||"".concat(e.first_name||""," ").concat(e.last_name||"")).toLowerCase(),r=(e.email||"").toLowerCase(),s=(e.phone||"").toLowerCase();if(!t.includes(n)&&!r.includes(n)&&!s.includes(n))return!1}var a=eA.trim().toLowerCase();return!a||!!(e.email||"").toLowerCase().includes(a)}),ni=(0,c.useState)([]),nl=ni[0],no=ni[1],nc=(0,c.useState)([]),nd=nc[0],nu=nc[1],nm=(0,c.useState)(null),nx=nm[0],nh=nm[1],ng=(0,c.useState)(""),np=ng[0],nf=ng[1],nb=(0,c.useState)(""),nj=nb[0],nv=nb[1],ny={all:et.length,admin:(null===(D=ea.admin)||void 0===D?void 0:D.length)||0,restaurant:(null===(q=ea.restaurant)||void 0===q?void 0:q.length)||0,customer:(null===(K=ea.customer)||void 0===K?void 0:K.length)||0,user:(null===(V=ea.user)||void 0===V?void 0:V.length)||0},nw=[{title:(0,B.jsx)(j.Z,{onChange:function(e){return nk(e.target.checked)},checked:nl.length>0&&nl.length===ns.length,indeterminate:nl.length>0&&nl.length<ns.length}),dataIndex:"selection",key:"selection",width:50,render:function(e,n){return(0,B.jsx)(j.Z,{checked:nl.includes(n.id),onChange:function(e){return nN(n.id,e.target.checked)}})}},{title:"Name",dataIndex:"name",key:"name",render:function(e,n){return(0,B.jsxs)("span",{children:[n.first_name," ",n.last_name]})}},{title:"E-Mail",dataIndex:"email",key:"email"},{title:"Rolle",dataIndex:"role",key:"role",render:function(e){var n="blue";return"ADMIN"===e&&(n="red"),"RESTAURANT"===e&&(n="green"),(0,B.jsx)(v.Z,{color:n,text:e})}},{title:(0,B.jsxs)("div",{className:"flex items-center",children:[(0,B.jsx)(Z.Z,{className:"mr-1"})," Tags"]}),dataIndex:"tags",key:"tags",render:function(e,n){var t=n.tags||[];return 0===t.length?(0,B.jsx)("span",{className:"text-gray-400 text-xs italic",children:"Keine Tags"}):(0,B.jsx)("div",{className:"flex flex-wrap gap-1",children:t.map(function(e){var n=nd.find(function(n){return n.id===e});return n?(0,B.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",title:n.description||"",children:[(0,B.jsx)(Z.Z,{className:"mr-1",style:{fontSize:"10px"}}),n.name]},e):null})})}},{title:"Telefon",dataIndex:"phone",key:"phone"},{title:"Status",dataIndex:"status",key:"status",render:function(e,n){return(0,B.jsx)(v.Z,{status:n.email_confirmed_at?"success":"warning",text:n.email_confirmed_at?"Best\xe4tigt":"Unbest\xe4tigt"})}},{title:"Registriert am",dataIndex:"created_at",key:"created_at",render:function(e){return e5(e)}},{title:"Letzter Login",dataIndex:"last_sign_in_at",key:"last_sign_in_at",render:function(e){return e?e5(e):"Nie"}},{title:"Aktionen",key:"actions",render:function(e,n){return(0,B.jsxs)("div",{className:"flex space-x-2",children:[(0,B.jsx)(y.ZP,{icon:(0,B.jsx)(S.Z,{}),size:"small",onClick:function(){return e8(n)},title:"Benutzer bearbeiten"}),(0,B.jsx)(y.ZP,{icon:(0,B.jsx)(z.Z,{}),size:"small",onClick:function(){return ne(n)},title:"Passwort \xe4ndern"}),(0,B.jsx)(y.ZP,{icon:(0,B.jsx)(T.Z,{}),size:"small",danger:!0,onClick:function(){return nr(n)},title:"Benutzer l\xf6schen"})]})}}],nN=function(e,n){n?no(function(n){return[].concat((0,r.Z)(n),[e])}):no(function(n){return n.filter(function(n){return n!==e})})},nk=function(e){e?no(ns.map(function(e){return e.id})):no([])},n_=(L=(0,i.Z)(o().mark(function e(){var n,t,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(np.trim()){e.next=3;break}return b.ZP.error("Bitte geben Sie einen Tag-Namen ein"),e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch("/api/admin/tags",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:np.trim(),description:nj.trim()||void 0})});case 6:if(!(n=e.sent).ok){e.next=17;break}return e.next=10,n.json();case 10:t=e.sent,nu(function(e){return[].concat((0,r.Z)(e),[t])}),nf(""),nv(""),b.ZP.success("Tag erfolgreich erstellt"),e.next=21;break;case 17:return e.next=19,n.json();case 19:s=e.sent,b.ZP.error(s.error||"Fehler beim Erstellen des Tags");case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(3),console.error("Fehler beim Erstellen des Tags:",e.t0),b.ZP.error("Fehler beim Erstellen des Tags");case 27:case"end":return e.stop()}},e,null,[[3,23]])})),function(){return L.apply(this,arguments)}),nZ=(M=(0,i.Z)(o().mark(function e(){var n,t,r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(nx){e.next=3;break}return b.ZP.error("Bitte w\xe4hlen Sie einen Tag aus"),e.abrupt("return");case 3:if(0!==nl.length){e.next=6;break}return b.ZP.error("Bitte w\xe4hlen Sie mindestens einen Benutzer aus"),e.abrupt("return");case 6:return e.prev=6,e.next=9,fetch("/api/admin/tags/assign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userIds:nl,tagId:nx})});case 9:if(!(n=e.sent).ok){e.next=22;break}return e.next=13,n.json();case 13:return t=e.sent,b.ZP.success("Tag erfolgreich ".concat(t.assigned," Benutzern zugewiesen")),e.next=17,e4();case 17:nT(!1),no([]),nh(void 0),e.next=26;break;case 22:return e.next=24,n.json();case 24:r=e.sent,b.ZP.error(r.error||"Fehler beim Zuweisen des Tags");case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(6),console.error("Fehler beim Zuweisen des Tags:",e.t0),b.ZP.error("Fehler beim Zuweisen des Tags");case 32:case"end":return e.stop()}},e,null,[[6,28]])})),function(){return M.apply(this,arguments)}),nS=(0,c.useState)(!1),nz=nS[0],nT=nS[1],nC=(0,c.useState)(!1),nP=(nC[0],nC[1]),nF=(I=(0,i.Z)(o().mark(function e(){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Lade Tags..."),e.next=4,fetch("/api/admin/tags/list");case 4:if((n=e.sent).ok){e.next=7;break}throw Error("Fehler beim Laden der Tags: ".concat(n.status));case 7:return e.next=9,n.json();case 9:nu(e.sent.tags||[]),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Fehler beim Laden der Tags:",e.t0),b.ZP.error("Tags konnten nicht geladen werden"),nu([]);case 18:case"end":return e.stop()}},e,null,[[0,13]])})),function(){return I.apply(this,arguments)}),nB=(R=(0,i.Z)(o().mark(function e(n,t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w.Z.confirm({title:"Tag l\xf6schen",icon:(0,B.jsx)(C.Z,{}),content:(0,B.jsxs)("div",{children:[(0,B.jsxs)("p",{children:["M\xf6chten Sie den Tag ",(0,B.jsx)("strong",{children:t})," wirklich l\xf6schen?"]}),(0,B.jsx)("p",{className:"text-red-500",children:"Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden und entfernt den Tag von allen Benutzern."})]}),okText:"Ja, l\xf6schen",okType:"danger",cancelText:"Abbrechen",onOk:function(){var e=(0,i.Z)(o().mark(function e(){var r,s;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/admin/users/delete-tag?tagId=".concat(n),{method:"DELETE"});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.json();case 7:throw Error(e.sent.error||"Fehler beim L\xf6schen des Tags: ".concat(r.status));case 9:return e.next=11,r.json();case 11:return s=e.sent,b.ZP.success(s.message||'Tag "'.concat(t,'" wurde erfolgreich gel\xf6scht')),eK===n&&(eV("all"),eY([])),e.next=16,nF();case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("Fehler beim L\xf6schen des Tags:",e.t0),b.ZP.error("Fehler beim L\xf6schen des Tags: ".concat(e.t0 instanceof Error?e.t0.message:"Unbekannter Fehler"));case 22:case"end":return e.stop()}},e,null,[[0,18]])}));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e)})),function(e,n){return R.apply(this,arguments)}),nE=(U=(0,i.Z)(o().mark(function e(n){var t,r,s,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Tag-Filter ge\xe4ndert auf: ".concat(n)),eV(n),"all"!==n){e.next=6;break}return console.log('Filter zur\xfcckgesetzt auf "Alle"'),eY([]),e.abrupt("return");case 6:if(eX(!0),e.prev=7,"none"!==n){e.next=15;break}return console.log("Rufe Benutzer ohne Tags ab..."),e.next=12,fetch("/api/admin/users/without-tags");case 12:t=e.sent,e.next=19;break;case 15:return console.log("Rufe Benutzer mit Tag ID ".concat(n," ab...")),e.next=18,fetch("/api/admin/users/by-tag?tagId=".concat(n));case 18:t=e.sent;case 19:if(t.ok){e.next=25;break}return e.next=22,t.text();case 22:throw r=e.sent,console.error("API-Fehler (".concat(t.status,"):"),r),Error("Fehler beim Laden der Benutzer nach Tag: ".concat(t.status));case 25:return e.next=27,t.json();case 27:console.log("API-Antwort erhalten:",s=e.sent),Array.isArray(s.users)?(a=s.users.map(function(e){return e.id}),console.log("".concat(a.length," Benutzer mit diesem Tag gefunden:"),a),eY(a)):(console.warn("Keine Benutzer in der API-Antwort gefunden oder ung\xfcltiges Format"),eY([])),e.next=37;break;case 32:e.prev=32,e.t0=e.catch(7),console.error("Fehler beim Filtern nach Tag:",e.t0),b.ZP.error("Fehler beim Filtern nach Tag: ".concat(e.t0 instanceof Error?e.t0.message:"Unbekannter Fehler")),eY([]);case 37:return e.prev=37,eX(!1),e.finish(37);case 40:case"end":return e.stop()}},e,null,[[7,32,37,40]])})),function(e){return U.apply(this,arguments)});return(0,B.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,B.jsx)(m.Z,{}),(0,B.jsxs)("div",{className:"flex flex-1",children:[(0,B.jsx)(h.Z,{activeItem:"users"}),(0,B.jsx)("main",{className:"flex-1 p-6 bg-gray-50",children:(0,B.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,B.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,B.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Benutzer"}),(0,B.jsxs)("div",{className:"flex space-x-3",children:[(0,B.jsx)("button",{onClick:e9,disabled:eh,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center ".concat(eh?"opacity-70 cursor-not-allowed":""),children:eh?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(g.Bw1,{className:"animate-spin mr-2"}),"Wird aktualisiert..."]}):"Aktualisieren"}),(0,B.jsx)(y.ZP,{type:"primary",icon:(0,B.jsx)(P.Z,{}),onClick:function(){return nP(!0)},children:"Benutzer hinzuf\xfcgen"}),nl.length>0&&(0,B.jsxs)(y.ZP,{className:"ml-2",icon:(0,B.jsx)(Z.Z,{}),onClick:function(){console.log("Tags zuweisen Button geklickt"),nT(!0)},children:["Tags zuweisen (",nl.length,")"]})]})]}),(0,B.jsx)("div",{className:"mb-6",children:(0,B.jsxs)("div",{className:"flex flex-wrap border-b border-gray-200",children:[(0,B.jsxs)("button",{onClick:function(){return ec("all")},className:"mr-2 py-2 px-4 font-medium text-sm rounded-t-lg ".concat("all"===eo?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,B.jsx)(p.I$,{className:"inline mr-1"})," Alle (",ny.all,")"]}),(0,B.jsxs)("button",{onClick:function(){return ec("admin")},className:"mr-2 py-2 px-4 font-medium text-sm rounded-t-lg ".concat("admin"===eo?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,B.jsx)(p.Xws,{className:"inline mr-1"})," Admins (",ny.admin,")"]}),(0,B.jsxs)("button",{onClick:function(){return ec("restaurant")},className:"mr-2 py-2 px-4 font-medium text-sm rounded-t-lg ".concat("restaurant"===eo?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,B.jsx)(p.yQ2,{className:"inline mr-1"})," Restaurants (",ny.restaurant,")"]}),(0,B.jsxs)("button",{onClick:function(){return ec("customer")},className:"mr-2 py-2 px-4 font-medium text-sm rounded-t-lg ".concat("customer"===eo?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,B.jsx)(p.I$,{className:"inline mr-1"})," Kunden (",ny.customer,")"]}),(0,B.jsxs)("button",{onClick:function(){return ec("user")},className:"mr-2 py-2 px-4 font-medium text-sm rounded-t-lg ".concat("user"===eo?"bg-gray-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,B.jsx)(p.Xws,{className:"inline mr-1"})," Sonstige (",ny.user,")"]})]})}),(0,B.jsxs)("div",{className:"mb-4 bg-white shadow-sm rounded-lg border border-gray-200 p-4",children:[(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[(0,B.jsxs)("div",{className:"col-span-2",children:[(0,B.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Suche"}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsx)(g.jRj,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,B.jsx)(N.Z,{type:"text",value:eF,onChange:function(e){return eB(e.target.value)},placeholder:"Name, E-Mail oder Telefon suchen",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"E-Mail enth\xe4lt"}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsx)(g.Imn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,B.jsx)(N.Z,{type:"text",value:eA,onChange:function(e){return eO(e.target.value)},placeholder:"z.B. @domain.de",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),(0,B.jsxs)(k.Z,{value:eM,onChange:function(e){return eI(e)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,B.jsx)(k.Z.Option,{value:"all",children:"Alle"}),(0,B.jsx)(k.Z.Option,{value:"active",children:"Aktiv"}),(0,B.jsx)(k.Z.Option,{value:"inactive",children:"Inaktiv"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Tag-Filter"}),(0,B.jsxs)(k.Z,{value:eK,onChange:nE,loading:eW,className:"w-full",placeholder:"Nach Tag filtern",suffixIcon:eW?(0,B.jsx)(F.Z,{}):(0,B.jsx)(Z.Z,{}),optionLabelProp:"label",dropdownRender:function(e){return(0,B.jsxs)(B.Fragment,{children:[e,0===nd.length&&(0,B.jsx)("div",{className:"p-2 text-xs text-gray-500 border-t",children:'Keine Tags vorhanden. Erstellen Sie Tags \xfcber den Button "Tags zuweisen".'})]})},children:[(0,B.jsx)(k.Z.Option,{value:"all",label:"Alle Tags",children:(0,B.jsxs)("div",{className:"flex items-center",children:[(0,B.jsx)(Z.Z,{className:"mr-2"}),(0,B.jsx)("span",{children:"Alle Tags"})]})}),(0,B.jsx)(k.Z.Option,{value:"none",label:"Keine Tags",children:(0,B.jsxs)("div",{className:"flex items-center",children:[(0,B.jsx)(Z.Z,{className:"mr-2",style:{opacity:.5}}),(0,B.jsx)("span",{children:"Keine Tags"})]})}),nd.map(function(e){return(0,B.jsxs)(k.Z.Option,{value:e.id,label:"".concat(e.name," (").concat(e.userCount||0,")"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{className:"flex items-center",children:[(0,B.jsx)(Z.Z,{className:"mr-2",style:{color:"#6366f1"}}),(0,B.jsx)("span",{children:e.name})]}),(0,B.jsxs)("div",{className:"flex items-center",children:[e.userCount>0&&(0,B.jsx)("span",{className:"bg-gray-100 text-gray-700 text-xs px-1.5 py-0.5 rounded-full mr-2",children:e.userCount}),(0,B.jsx)(y.ZP,{type:"text",size:"small",icon:(0,B.jsx)(T.Z,{style:{color:"#f5222d"}}),onClick:function(n){n.stopPropagation(),nB(e.id,e.name)},title:"Tag l\xf6schen",className:"opacity-70 hover:opacity-100"})]})]}),e.description&&(0,B.jsx)("div",{className:"text-xs text-gray-500 mt-1 pl-6",children:e.description})]},e.id)})]})]}),(0,B.jsxs)("div",{className:"flex items-end justify-between",children:[(0,B.jsxs)("label",{className:"inline-flex items-center text-sm text-gray-700",children:[(0,B.jsx)(N.Z,{type:"checkbox",checked:eU,onChange:function(e){return eD(e.target.checked)},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded mr-2"}),"Nur mit Telefonnummer"]}),(0,B.jsx)(y.ZP,{onClick:function(){eB(""),eO(""),eI("all"),eD(!1),eV("all"),eY([])},className:"ml-4 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-sm",title:"Filter zur\xfccksetzen",children:"Zur\xfccksetzen"})]})]}),(0,B.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,B.jsx)(g.Ihx,{className:"inline mr-1"})," Ergebnis: ",na.length," von ",ns.length," in diesem Tab"]})]}),(0,B.jsx)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsx)(_.Z,{columns:nw,dataSource:na,rowKey:"id",loading:eu,pagination:{pageSize:eH,current:e2,pageSizeOptions:["10","20","50","100"],showSizeChanger:!0,onChange:function(e,n){e3(e),n!==eH&&e0(n)},onShowSizeChange:function(e,n){e0(n),e3(1)},showTotal:function(e,n){return"".concat(n[0],"-").concat(n[1]," von ").concat(e," Eintr\xe4gen")}},rowSelection:{selectedRowKeys:nl,onChange:function(e){return no(e)},columnWidth:50}})})})]})})]}),(0,B.jsx)(x.Z,{}),ef&&(0,B.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,B.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,B.jsx)("h2",{className:"text-xl font-bold mb-4",children:eN?"Benutzer bearbeiten":"Neuer Benutzer"}),(0,B.jsxs)("form",{onSubmit:nn,children:[(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"E-Mail"}),(0,B.jsx)(N.Z,{type:"email",id:"email",name:"email",value:eZ.email,onChange:e6,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0,disabled:!!eN})]}),!eN&&(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Passwort"}),(0,B.jsx)(f.Z,{id:"password",name:"password",value:eZ.password,onChange:e6,className:"w-full",required:!eN})]}),(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rolle"}),(0,B.jsxs)(k.Z,{id:"role",name:"role",value:eZ.role,onChange:e6,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[(0,B.jsx)(k.Z.Option,{value:"admin",children:"Admin"}),(0,B.jsx)(k.Z.Option,{value:"restaurant",children:"Restaurant"}),(0,B.jsx)(k.Z.Option,{value:"customer",children:"Kunde"}),(0,B.jsx)(k.Z.Option,{value:"user",children:"Benutzer"})]})]}),(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Vorname"}),(0,B.jsx)(N.Z,{type:"text",id:"first_name",name:"first_name",value:eZ.first_name,onChange:e6,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nachname"}),(0,B.jsx)(N.Z,{type:"text",id:"last_name",name:"last_name",value:eZ.last_name,onChange:e6,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefon"}),(0,B.jsx)(N.Z,{type:"tel",id:"phone",name:"phone",value:eZ.phone,onChange:e6,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),"restaurant"===eZ.role.toLowerCase()&&(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"restaurant_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Restaurantname"}),(0,B.jsx)(N.Z,{type:"text",id:"restaurant_name",name:"restaurant_name",value:eZ.restaurant_name,onChange:e6,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"}),(0,B.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,B.jsx)(N.Z,{type:"checkbox",id:"restaurant_isVisible",name:"restaurant_isVisible",checked:eZ.restaurant_isVisible,onChange:e6,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,B.jsx)("label",{htmlFor:"restaurant_isVisible",className:"ml-2 block text-sm text-gray-900",children:"\xd6ffentlich sichtbar"})]})]}),"admin"===eZ.role.toLowerCase()&&(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("div",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin-Berechtigungen"}),(0,B.jsxs)("div",{className:"flex items-center mb-2",children:[(0,B.jsx)(N.Z,{type:"checkbox",id:"admin_canManageUsers",name:"admin_canManageUsers",checked:eZ.admin_canManageUsers,onChange:e6,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,B.jsx)("label",{htmlFor:"admin_canManageUsers",className:"ml-2 block text-sm text-gray-900",children:"Benutzer verwalten"})]}),(0,B.jsxs)("div",{className:"flex items-center",children:[(0,B.jsx)(N.Z,{type:"checkbox",id:"admin_canManageSettings",name:"admin_canManageSettings",checked:eZ.admin_canManageSettings,onChange:e6,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,B.jsx)("label",{htmlFor:"admin_canManageSettings",className:"ml-2 block text-sm text-gray-900",children:"Einstellungen verwalten"})]})]}),eN&&(0,B.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,B.jsx)(N.Z,{type:"checkbox",id:"is_active",name:"is_active",checked:eZ.is_active,onChange:e6,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,B.jsx)("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Aktiv"})]}),(0,B.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,B.jsx)(y.ZP,{onClick:function(){return eb(!1)},className:"mr-2",children:"Abbrechen"}),(0,B.jsx)(y.ZP,{type:"primary",htmlType:"submit",className:"bg-indigo-600 hover:bg-indigo-700 text-white",children:"Speichern"})]})]})]})}),nz&&(0,B.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,B.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,B.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,B.jsx)("h2",{className:"text-xl font-bold",children:"Tags zuweisen"}),(0,B.jsxs)("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded",children:[nl.length," Benutzer ausgew\xe4hlt"]})]}),(0,B.jsxs)("div",{className:"mb-5",children:[(0,B.jsx)("label",{htmlFor:"tag-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"Vorhandene Tags"}),0===nd.length?(0,B.jsx)("div",{className:"text-sm text-gray-500 italic mb-2 bg-gray-50 p-3 rounded border border-gray-200",children:"Keine Tags vorhanden. Erstellen Sie unten einen neuen Tag."}):(0,B.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:nd.map(function(e){return(0,B.jsxs)("div",{onClick:function(){return nh(e.id)},className:"cursor-pointer px-3 py-1.5 rounded-full text-sm flex items-center gap-1.5 transition-colors ".concat(nx===e.id?"bg-indigo-100 text-indigo-800 border border-indigo-300":"bg-gray-100 hover:bg-gray-200 text-gray-800 border border-gray-200"),children:[(0,B.jsx)(Z.Z,{style:{fontSize:"14px"}}),e.name,e.userCount>0&&(0,B.jsx)("span",{className:"bg-gray-200 text-gray-700 text-xs px-1.5 py-0.5 rounded-full",children:e.userCount})]},e.id)})}),(0,B.jsx)(k.Z,{id:"tag-select",value:nx,onChange:function(e){return nh(e)},className:"w-full",placeholder:"Oder w\xe4hlen Sie einen Tag aus der Liste",allowClear:!0,children:nd.map(function(e){return(0,B.jsxs)(k.Z.Option,{value:e.id,children:[e.name," ",e.userCount?"(".concat(e.userCount," Benutzer)"):""]},e.id)})})]}),(0,B.jsxs)("div",{className:"mb-5 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[(0,B.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,B.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[(0,B.jsx)(P.Z,{className:"mr-1"})," Neuen Tag erstellen"]})}),(0,B.jsx)(N.Z,{type:"text",value:np,onChange:function(e){return nf(e.target.value)},placeholder:"Tag-Name",className:"w-full mb-2",maxLength:50}),(0,B.jsx)(N.Z,{type:"text",value:nj,onChange:function(e){return nv(e.target.value)},placeholder:"Beschreibung (optional)",className:"w-full mb-2",maxLength:200}),(0,B.jsx)(y.ZP,{onClick:n_,type:"primary",className:"w-full",disabled:!np.trim(),icon:(0,B.jsx)(P.Z,{}),children:"Tag erstellen"})]}),(0,B.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 border-t pt-4 border-gray-200",children:[(0,B.jsx)(y.ZP,{onClick:function(){return nT(!1)},children:"Abbrechen"}),(0,B.jsx)(y.ZP,{type:"primary",onClick:nZ,disabled:!nx||0===nl.length,icon:(0,B.jsx)(Z.Z,{}),children:"Tag zuweisen"})]})]})}),ev&&(0,B.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,B.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,B.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Passwort \xe4ndern f\xfcr ",null==eN?void 0:eN.email]}),(0,B.jsxs)("form",{onSubmit:nt,children:[(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Neues Passwort"}),(0,B.jsx)(f.Z,{id:"password",name:"password",value:eT.password,onChange:e7,className:"w-full",required:!0})]}),(0,B.jsxs)("div",{className:"mb-4",children:[(0,B.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Passwort best\xe4tigen"}),(0,B.jsx)(f.Z,{id:"confirmPassword",name:"confirmPassword",value:eT.confirmPassword,onChange:e7,className:"w-full",required:!0})]}),(0,B.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,B.jsx)("button",{type:"button",onClick:function(){return ey(!1)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300",children:"Abbrechen"}),(0,B.jsx)("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Passwort \xe4ndern"})]})]})]})})]})}},64168:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users",function(){return t(86553)}])}},function(e){e.O(0,[6130,3365,6058,6405,8428,300,4741,5657,6937,3708,2888,9774,179],function(){return e(e.s=64168)}),_N_E=e.O()}]);