(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6836],{20796:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return h}});var n=r(50029),s=r(64687),a=r.n(s),l=r(92401),i=r(11163),c=r(63708),d=r(17662),u=r(95443),o=r(88314),x=r(5802),h=!0;t.default=function(e){var t,r,s=(0,i.useRouter)(),h=(0,l.useState)(""),m=h[0],p=h[1],f=(0,l.useState)(""),b=f[0],g=f[1],v=(0,l.useState)(""),j=v[0],N=v[1],y=(0,l.useState)(""),k=y[0],w=y[1],S=(0,l.useState)(null),_=S[0],T=S[1],C=(0,l.useState)(!1),E=C[0],Z=C[1],B=(0,l.useState)(!1),F=B[0],O=B[1],P=(0,l.useState)(!1),I=P[0],z=P[1],A=(0,l.useRef)(null),D=(t=(0,n.Z)(a().mark(function e(t){var r,n,s,l;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===(r=t.target.files)||void 0===r?void 0:r[0]){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,z(!0),(s=new FormData).append("file",n),e.next=9,fetch("/api/upload/image",{method:"POST",body:s});case 9:if((l=e.sent).ok){e.next=16;break}return e.t0=Error,e.next=14,l.text();case 14:throw e.t1=e.sent,new e.t0(e.t1);case 16:return e.next=18,l.json();case 18:T(e.sent.url),e.next=26;break;case 22:e.prev=22,e.t2=e.catch(3),console.error("Featured upload failed",e.t2),alert("Fehler beim Hochladen des Titelbildes");case 26:return e.prev=26,z(!1),A.current&&(A.current.value=""),e.finish(26);case 30:case"end":return e.stop()}},e,null,[[3,22,26,30]])})),function(e){return t.apply(this,arguments)}),R=(r=(0,n.Z)(a().mark(function e(t){var r,n,l,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(!m.trim()||!k.trim())){e.next=4;break}return alert("Titel und Inhalt sind erforderlich"),e.abrupt("return");case 4:return e.prev=4,O(!0),e.next=8,fetch("/api/admin/blogs/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:m.trim(),slug:b.trim()||void 0,excerpt:j.trim(),content:k,featured_image:_,published:E})});case 8:return n=e.sent,e.next=11,n.json();case 11:if(l=e.sent,n.ok){e.next=14;break}throw Error((null==l?void 0:l.message)||"Fehler");case 14:(i=null==l||null===(r=l.post)||void 0===r?void 0:r.id)?s.push("/admin/blogs/edit/".concat(i)):s.push("/admin/blogs"),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(4),console.error(e.t0),alert((null===e.t0||void 0===e.t0?void 0:e.t0.message)||"Fehler beim Erstellen");case 22:return e.prev=22,O(!1),e.finish(22);case 25:case"end":return e.stop()}},e,null,[[4,18,22,25]])})),function(e){return r.apply(this,arguments)});return(0,x.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,x.jsx)(c.Z,{}),(0,x.jsxs)("div",{className:"flex flex-1",children:[(0,x.jsx)(u.Z,{activeItem:"blogs"}),(0,x.jsx)("main",{className:"flex-1 p-6 bg-gray-50",children:(0,x.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,x.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,x.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Neuen Blog-Beitrag erstellen"})}),(0,x.jsxs)("form",{onSubmit:R,className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6 space-y-6",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titel"}),(0,x.jsx)("input",{type:"text",value:m,onChange:function(e){return p(e.target.value)},className:"w-full border rounded px-3 py-2",placeholder:"Titel des Beitrags"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug (optional)"}),(0,x.jsx)("input",{type:"text",value:b,onChange:function(e){return g(e.target.value)},className:"w-full border rounded px-3 py-2",placeholder:"automatisch aus Titel, falls leer"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Auszug"}),(0,x.jsx)("textarea",{value:j,onChange:function(e){return N(e.target.value)},className:"w-full border rounded px-3 py-2 min-h-[80px]",placeholder:"Kurzer Teaser-Text"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Inhalt"}),(0,x.jsx)(o.Z,{value:k,onChange:w,placeholder:"Schreiben Sie Ihren Beitrag..."})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titelbild"}),(0,x.jsxs)("div",{className:"flex items-center gap-3",children:[(0,x.jsx)("button",{type:"button",className:"px-3 py-2 border rounded",onClick:function(){var e;return null===(e=A.current)||void 0===e?void 0:e.click()},disabled:I,children:I?"Wird hochgeladen...":"Bild hochladen"}),_&&(0,x.jsx)("a",{href:_,target:"_blank",rel:"noreferrer",className:"text-indigo-600 underline text-sm",children:"Vorschau"}),(0,x.jsx)("input",{hidden:!0,ref:A,type:"file",accept:"image/*",onChange:D})]})]}),(0,x.jsx)("div",{className:"flex items-end",children:(0,x.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,x.jsx)("input",{type:"checkbox",checked:E,onChange:function(e){return Z(e.target.checked)}}),(0,x.jsx)("span",{className:"text-sm text-gray-700",children:"Ver\xf6ffentlicht"})]})})]}),(0,x.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,x.jsx)("button",{type:"button",className:"px-4 py-2 border rounded",onClick:function(){return s.push("/admin/blogs")},children:"Abbrechen"}),(0,x.jsx)("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded",disabled:F,children:F?"Speichern...":"Erstellen"})]})]})]})})]}),(0,x.jsx)(d.Z,{})]})}},73872:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/blogs/create",function(){return r(20796)}])}},function(e){e.O(0,[6130,3365,6911,1509,6058,6405,8428,300,1012,3708,2567,2888,9774,179],function(){return e(e.s=73872)}),_N_E=e.O()}]);