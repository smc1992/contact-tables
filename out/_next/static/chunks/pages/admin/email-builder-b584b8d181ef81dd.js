(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[896],{95443:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(92401),a=n(41664),s=n.n(a),i=n(11163),l=n(89681),c=n(91472),o=n(5802);function d(e){var t=e.activeItem,n=void 0===t?"dashboard":t,a=(0,i.useRouter)(),d=(0,r.useState)(!1),u=d[0],m=d[1],h=[{icon:c.m6D,label:"Dashboard",id:"dashboard",path:"/admin/dashboard"},{icon:c.LSm,label:"Partneranfragen",id:"partner-requests",path:"/admin/partner-requests"},{icon:c.SnF,label:"Restaurants",id:"restaurants",path:"/admin/restaurants"},{icon:c.orK,label:"Kontakttisch-Analysen",id:"contact-tables-analytics",path:"/admin/contact-tables/analytics"},{icon:c.bfl,label:"Moderation",id:"moderation",path:"/admin/moderation/reviews"},{icon:c.zFh,label:"Abonnements",id:"subscriptions",path:"/admin/subscriptions"},{icon:c.aCJ,label:"Kategorien",id:"categories",path:"/admin/categories"},{icon:c.E25,label:"Ausstattung",id:"amenities",path:"/admin/amenities"},{icon:c.i63,label:"St\xe4dte",id:"cities",path:"/admin/cities"},{icon:c.WY8,label:"Benutzer",id:"users",path:"/admin/users",useRouterPush:!0},{icon:c.NOg,label:"Blogs",id:"blogs",path:"/admin/blogs"},{icon:c.Imn,label:"Newsletter",id:"newsletter",path:"/admin/newsletters"},{icon:c.Imn,label:"E-Mail-Builder",id:"email-builder",path:"/admin/email-builder"},{icon:c.nbt,label:"Einstellungen",id:"settings",path:"/admin/settings"}];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"fixed bottom-4 right-4 md:hidden z-30",children:(0,o.jsx)("button",{onClick:function(){return m(!u)},className:"bg-primary-600 text-white p-3 rounded-full shadow-lg",children:u?(0,o.jsx)(c.q5L,{size:24}):(0,o.jsx)(c.cur,{size:24})})}),(0,o.jsx)(l.E.div,{className:"fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden",initial:{opacity:0},animate:{opacity:u?1:0},transition:{duration:.2},style:{pointerEvents:u?"auto":"none"},children:(0,o.jsxs)(l.E.div,{className:"fixed inset-y-0 left-0 w-64 bg-white shadow-xl z-30 overflow-y-auto",initial:{x:"-100%"},animate:{x:u?0:"-100%"},transition:{duration:.3},children:[(0,o.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Admin"}),(0,o.jsx)("button",{onClick:function(){return m(!1)},className:"text-gray-500 hover:text-gray-700",children:(0,o.jsx)(c.q5L,{size:24})})]})}),(0,o.jsx)("nav",{className:"p-4",children:(0,o.jsx)("ul",{className:"space-y-2",children:h.map(function(e){var t=e.icon,r=n===e.id;return(0,o.jsx)("li",{children:e.useRouterPush?(0,o.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors cursor-pointer ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Mobile): Router.push zu ".concat(e.label," (").concat(e.path,")")),a.push(e.path),m(!1)},children:[(0,o.jsx)(t,{size:20}),(0,o.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,o.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]}):(0,o.jsxs)(s(),{href:e.path,className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Mobile): Link zu ".concat(e.label," (").concat(e.path,") geklickt")),m(!1)},children:[(0,o.jsx)(t,{size:20}),(0,o.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,o.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]})},e.id)})})})]})}),(0,o.jsx)("aside",{className:"hidden md:block w-64 bg-white shadow-md min-h-screen pt-20",children:(0,o.jsx)("nav",{className:"p-4",children:(0,o.jsx)("ul",{className:"space-y-2",children:h.map(function(e){var t=e.icon,r=n===e.id;return(0,o.jsx)("li",{children:e.useRouterPush?(0,o.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors cursor-pointer ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Desktop): Router.push zu ".concat(e.label," (").concat(e.path,")")),a.push(e.path)},children:[(0,o.jsx)(t,{size:20}),(0,o.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,o.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]}):(0,o.jsxs)(s(),{href:e.path,className:"flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat(r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100"),onClick:function(){console.log("AdminSidebar (Desktop): Link zu ".concat(e.label," (").concat(e.path,") geklickt"))},children:[(0,o.jsx)(t,{size:20}),(0,o.jsx)("span",{children:e.label}),"partner-requests"===e.id&&(0,o.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"Neu"})]})},e.id)})})})})]})}},17662:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(41664),a=n.n(r),s=n(25675),i=n.n(s),l=n(91472),c=n(41338),o=n(5802);function d(){return(0,o.jsx)("footer",{className:"bg-gradient-to-br from-neutral-900 to-neutral-800 text-neutral-300",children:(0,o.jsxs)("div",{className:"container mx-auto py-16 px-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-12",children:[(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsx)(a(),{href:"/",className:"inline-block",children:(0,o.jsx)("div",{className:"flex items-center space-x-3 group",children:(0,o.jsx)("div",{className:"h-12 bg-white p-2 rounded-lg overflow-hidden relative",children:(0,o.jsx)(i(),{src:"/images/logo-fixed/Logo CT quer 4c.webp",alt:"Contact Tables Logo",width:120,height:40,className:"transition-all group-hover:scale-105",priority:!0,style:{objectFit:"contain",width:"auto",height:"100%"},quality:100})})})}),(0,o.jsx)("p",{className:"text-neutral-400 leading-relaxed",children:"Wir verbinden Menschen am Restauranttisch â€“ f\xfcr echte Begegnungen und inspirierende Gespr\xe4che."})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{className:"text-xl font-semibold text-white mb-6 border-b border-neutral-700 pb-3",children:"Entdecken"}),(0,o.jsxs)("ul",{className:"space-y-4",children:[(0,o.jsx)("li",{children:(0,o.jsxs)(a(),{href:"/restaurants",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,o.jsx)(l.i63,{className:"group-hover:translate-x-1 transition-transform"}),(0,o.jsx)("span",{children:"Restaurants finden"})]})}),(0,o.jsx)("li",{children:(0,o.jsxs)(a(),{href:"/about",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,o.jsx)(l.WY8,{className:"group-hover:translate-x-1 transition-transform"}),(0,o.jsx)("span",{children:"\xdcber uns"})]})}),(0,o.jsx)("li",{children:(0,o.jsxs)(a(),{href:"/restaurant/register",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,o.jsx)(l.i63,{className:"group-hover:translate-x-1 transition-transform"}),(0,o.jsx)("span",{children:"Restaurant anmelden"})]})}),(0,o.jsx)("li",{children:(0,o.jsxs)(a(),{href:"/events",className:"flex items-center space-x-2 text-neutral-400 hover:text-primary-400 transition-colors group",children:[(0,o.jsx)(l.TCC,{className:"group-hover:translate-x-1 transition-transform"}),(0,o.jsx)("span",{children:"Events & Aktionen"})]})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{className:"text-xl font-semibold text-white mb-6 border-b border-neutral-700 pb-3",children:"Rechtliches"}),(0,o.jsxs)("ul",{className:"space-y-4",children:[(0,o.jsx)("li",{children:(0,o.jsx)(a(),{href:"/datenschutz",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"Datenschutzerkl\xe4rung"})}),(0,o.jsx)("li",{children:(0,o.jsx)(a(),{href:"/faq",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"FAQ"})}),(0,o.jsx)("li",{children:(0,o.jsx)(a(),{href:"/impressum",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"Impressum"})}),(0,o.jsx)("li",{children:(0,o.jsx)(a(),{href:"/barrierefreiheit",className:"text-neutral-400 hover:text-primary-400 transition-colors",children:"Barrierefreiheit"})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{className:"text-xl font-semibold text-white mb-6 border-b border-neutral-700 pb-3",children:"Kontakt"}),(0,o.jsxs)("ul",{className:"space-y-4",children:[(0,o.jsx)("li",{className:"group",children:(0,o.jsxs)("a",{href:"tel:+4915679640069",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,o.jsx)(l.tUt,{size:16})}),(0,o.jsx)("span",{children:"+49 15679 640069"})]})}),(0,o.jsx)("li",{className:"group",children:(0,o.jsxs)(a(),{href:"/contact",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,o.jsx)(l.Imn,{size:16})}),(0,o.jsx)("span",{children:"Nachricht absenden"})]})}),(0,o.jsx)("li",{className:"group",children:(0,o.jsxs)("a",{href:"https://www.facebook.com/contacttables/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,o.jsx)(c.tBk,{size:16})}),(0,o.jsx)("span",{children:"Facebook"})]})}),(0,o.jsx)("li",{className:"group",children:(0,o.jsxs)("a",{href:"https://www.instagram.com/contacttables/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-3 text-neutral-400 hover:text-primary-400 transition-colors",children:[(0,o.jsx)("div",{className:"w-8 h-8 rounded-full bg-neutral-800 group-hover:bg-primary-700 flex items-center justify-center transition-all duration-300",children:(0,o.jsx)(c.Zf_,{size:16})}),(0,o.jsx)("span",{children:"Instagram"})]})})]})]})]}),(0,o.jsx)("div",{className:"border-t border-neutral-800 mt-16 pt-8 text-center",children:(0,o.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[(0,o.jsxs)("p",{className:"text-neutral-500",children:["\xa9 ",new Date().getFullYear()," contact-tables. Alle Rechte vorbehalten."]}),(0,o.jsxs)("p",{className:"flex items-center text-neutral-500",children:[(0,o.jsx)("span",{children:"Made with"})," ",(0,o.jsx)(l.$aX,{className:"mx-2 text-primary-500"})," ",(0,o.jsx)("span",{children:"in Germany"})]})]})})]})})}},98631:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return y},config:function(){return w}});var r=n(90116),a=n(50029),s=n(64687),i=n.n(s),l=n(92401),c=n(11163),o=n(87553),d=n(63708),u=n(17662),m=n(95443),h=n(5152),x=n.n(h),p=n(41664),f=n.n(p),g=n(91472),b=n(86561),j=n(30262);n(86834);var v=n(5802),N=x()(function(){return Promise.all([n.e(2937),n.e(733)]).then(n.t.bind(n,40733,23))},{ssr:!1,loadableGenerated:{webpack:function(){return[40733]}}}),y=!0,w={unstable_runtimeJS:!0,runtime:"nodejs"};t.default=function(e){e.user,(0,c.useRouter)();var t,n,s,h,x,p,y=(0,l.useState)(""),w=y[0],k=y[1],E=(0,l.useState)(""),S=E[0],C=E[1],F=(0,l.useState)([]),z=F[0],M=F[1],T=(0,l.useState)([]),A=T[0],_=T[1],B=(0,l.useState)([]),K=B[0],D=B[1],L=(0,l.useState)([]),Z=L[0],R=L[1],I=(0,l.useState)(""),P=I[0],q=I[1],O=(0,l.useState)(!0),V=O[0],G=O[1],U=(0,l.useState)(!0),W=U[0],J=U[1],Y=(0,l.useState)(!1),X=Y[0],H=Y[1],Q=(0,l.useState)(""),$=Q[0],ee=Q[1],et=(0,l.useState)(""),en=et[0],er=et[1],ea=(0,l.useState)(!1);ea[0],ea[1];var es=(0,l.useState)(""),ei=(es[0],es[1]),el=(0,l.useState)([]),ec=el[0],eo=el[1],ed=(0,l.useState)(""),eu=ed[0],em=ed[1],eh=(0,l.useState)(!0),ex=eh[0],ep=eh[1],ef=(0,l.useState)([]),eg=ef[0],eb=ef[1],ej=(0,l.useRef)(null);(0,o.createClient)();var ev=(t=(0,a.Z)(i().mark(function e(){var t,n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return G(!0),e.prev=1,e.next=4,fetch("/api/admin/email-users");case 4:return t=e.sent,e.next=7,t.json();case 7:if(n=e.sent,t.ok){e.next=10;break}throw Error(n.error||"Fehler beim Laden der Kunden");case 10:if(n.users){e.next=12;break}throw Error("Keine Benutzerdaten erhalten");case 12:_(r=n.users.map(function(e){var t,n;return{id:e.id,email:e.email||"",name:"".concat((null===(t=e.user_metadata)||void 0===t?void 0:t.first_name)||""," ").concat((null===(n=e.user_metadata)||void 0===n?void 0:n.last_name)||"").trim(),created_at:e.created_at}})),D([{id:"all",name:"Alle Kunden",description:"Alle registrierten Kunden",count:r.length},{id:"new",name:"Neue Kunden",description:"Kunden, die sich in den letzten 30 Tagen registriert haben",count:r.filter(function(e){var t=new Date(e.created_at),n=new Date;return n.setDate(n.getDate()-30),t>=n}).length}]),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(1),console.error("Fehler beim Laden der Kunden:",e.t0),_([]),D([]);case 22:return e.prev=22,G(!1),e.finish(22);case 25:case"end":return e.stop()}},e,null,[[1,17,22,25]])})),function(){return t.apply(this,arguments)}),eN=(n=(0,a.Z)(i().mark(function e(){var t,n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return J(!0),e.prev=1,e.next=4,fetch("/api/admin/emails/templates");case 4:if((t=e.sent).ok){e.next=7;break}throw Error("Fehler beim Laden der Vorlagen");case 7:return e.next=9,t.json();case 9:(n=e.sent).ok&&Array.isArray(n.data)?R(n.data):R([]),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Fehler beim Laden der Vorlagen:",e.t0),R([]);case 17:return e.prev=17,J(!1),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[1,13,17,20]])})),function(){return n.apply(this,arguments)}),ey=(s=(0,a.Z)(i().mark(function e(){var t,n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ep(!0),e.prev=1,e.next=4,fetch("/api/admin/tags/list");case 4:if((t=e.sent).ok){e.next=7;break}throw Error("Fehler beim Laden der Tags");case 7:return e.next=9,t.json();case 9:Array.isArray((n=e.sent).tags)?eo(n.tags):eo([]),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Fehler beim Laden der Tags:",e.t0),eo([]);case 17:return e.prev=17,ep(!1),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[1,13,17,20]])})),function(){return s.apply(this,arguments)}),ew=(h=(0,a.Z)(i().mark(function e(t){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(em(t),er(""),ee(""),G(!0),e.prev=4,"none"!==t){e.next=11;break}return e.next=8,fetch("/api/admin/users/without-tags");case 8:n=e.sent,e.next=14;break;case 11:return e.next=13,fetch("/api/admin/users/by-tag?tagId=".concat(t));case 13:n=e.sent;case 14:if(n.ok){e.next=16;break}throw Error("Error: ".concat(n.status));case 16:return e.next=18,n.json();case 18:_(e.sent.users||[]),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(4),console.error("Failed to fetch customers by tag:",e.t0),b.ZP.error("Fehler beim Laden der Kunden nach Tag"),_([]);case 27:return e.prev=27,G(!1),e.finish(27);case 30:case"end":return e.stop()}},e,null,[[4,22,27,30]])})),function(e){return h.apply(this,arguments)});(0,l.useEffect)(function(){ev(),eN(),ey()},[]);var ek=function(e){M(function(t){return t.includes(e)?t.filter(function(t){return t!==e}):[].concat((0,r.Z)(t),[e])})},eE=A.filter(function(e){var t=$.toLowerCase();return e.email.toLowerCase().includes(t)||e.name&&e.name.toLowerCase().includes(t)}),eS=function(e){eb(function(t){return t.filter(function(t){return t.id!==e})})},eC=(x=(0,a.Z)(i().mark(function e(){var t,n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!w||!S)){e.next=3;break}return alert("Bitte geben Sie einen Betreff und Inhalt ein."),e.abrupt("return");case 3:if(0!==z.length){e.next=6;break}return alert("Bitte w\xe4hlen Sie mindestens einen Empf\xe4nger aus."),e.abrupt("return");case 6:if(confirm("M\xf6chten Sie diese E-Mail an ".concat(z.length," Empf\xe4nger senden?"))){e.next=8;break}return e.abrupt("return");case 8:return H(!0),e.prev=9,t=A.filter(function(e){return z.includes(e.id)}).map(function(e){return{id:e.id,email:e.email,name:e.name||""}}),e.next=13,fetch("/api/admin/emails/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:w,content:S,recipients:t,templateId:P||void 0,attachments:eg.length>0?eg.map(function(e){return{filename:e.filename,content:e.content,contentType:e.contentType}}):void 0})});case 13:return n=e.sent,e.next=16,n.json();case 16:if(r=e.sent,n.ok){e.next=19;break}throw Error(r.message||"Fehler beim Senden der E-Mails");case 19:alert("E-Mails wurden erfolgreich gesendet! Erfolgreich: ".concat(r.sent,", Fehlgeschlagen: ").concat(r.failed)),k(""),C(""),M([]),q(""),er(""),eb([]),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(9),console.error("Fehler beim Senden der E-Mails:",e.t0),alert("Fehler beim Senden der E-Mails: ".concat(e.t0 instanceof Error?e.t0.message:"Unbekannter Fehler"));case 32:return e.prev=32,H(!1),e.finish(32);case 35:case"end":return e.stop()}},e,null,[[9,28,32,35]])})),function(){return x.apply(this,arguments)}),eF=(p=(0,a.Z)(i().mark(function e(){var t,n,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!w||!S)){e.next=3;break}return alert("Bitte geben Sie einen Betreff und Inhalt ein."),e.abrupt("return");case 3:if(t=prompt("Bitte geben Sie eine Test-E-Mail-Adresse ein:")){e.next=6;break}return e.abrupt("return");case 6:return ei(t),e.prev=7,H(!0),e.next=11,fetch("/api/admin/emails/send-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:w,content:S,to:t,templateId:P||void 0,attachments:eg.length>0?eg.map(function(e){return{filename:e.filename,content:e.content,contentType:e.contentType}}):void 0})});case 11:return n=e.sent,e.next=14,n.json();case 14:if(r=e.sent,n.ok){e.next=17;break}throw Error(r.message||"Fehler beim Senden der Test-E-Mail");case 17:alert("Test-E-Mail wurde erfolgreich gesendet!"),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(7),console.error("Fehler beim Senden der Test-E-Mail:",e.t0),alert("Fehler beim Senden der Test-E-Mail: ".concat(e.t0 instanceof Error?e.t0.message:"Unbekannter Fehler"));case 24:return e.prev=24,H(!1),e.finish(24);case 27:case"end":return e.stop()}},e,null,[[7,20,24,27]])})),function(){return p.apply(this,arguments)});return(0,v.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,v.jsx)(d.Z,{}),(0,v.jsxs)("div",{className:"flex flex-1",children:[(0,v.jsx)(m.Z,{activeItem:"email-builder"}),(0,v.jsx)("main",{className:"flex-1 p-6 bg-gray-50",children:(0,v.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"E-Mail-Builder"}),(0,v.jsx)("p",{className:"text-sm text-gray-500",children:"Erstellen und versenden Sie E-Mails an ausgew\xe4hlte Kunden"})]}),(0,v.jsxs)("div",{className:"flex space-x-3",children:[(0,v.jsxs)(f(),{href:"/admin/email-builder/history",className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center",children:[(0,v.jsx)(g.Imn,{className:"mr-2"}),"E-Mail-Verlauf"]}),(0,v.jsx)("button",{onClick:ev,disabled:V,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center ".concat(V?"opacity-70 cursor-not-allowed":""),children:V?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.Bw1,{className:"animate-spin mr-2"}),"Wird aktualisiert..."]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.Bw1,{className:"mr-2"}),"Aktualisieren"]})})]})]}),(0,v.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,v.jsx)("div",{className:"lg:col-span-2",children:(0,v.jsxs)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6 mb-6",children:[(0,v.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"E-Mail erstellen"}),(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("label",{htmlFor:"template",className:"block text-sm font-medium text-gray-700 mb-1",children:"Vorlage ausw\xe4hlen"}),(0,v.jsxs)("select",{id:"template",value:P,onChange:function(e){var t=e.target.value;if(q(t),t){var n=Z.find(function(e){return e.id===t});n&&(k(n.subject),C(n.content))}},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",disabled:W,children:[(0,v.jsx)("option",{value:"",children:"Keine Vorlage"}),W?(0,v.jsx)("option",{value:"",disabled:!0,children:"Vorlagen werden geladen..."}):0===Z.length?(0,v.jsx)("option",{value:"",disabled:!0,children:"Keine Vorlagen verf\xfcgbar"}):Z.map(function(e){return(0,v.jsx)("option",{value:e.id,children:e.name},e.id)})]})]}),(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Betreff"}),(0,v.jsx)("input",{type:"text",id:"subject",value:w,onChange:function(e){return k(e.target.value)},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Betreff der E-Mail"})]}),(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Inhalt"}),(0,v.jsx)("div",{className:"border rounded-md",children:(0,v.jsx)(N,{value:S,onChange:C,modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image"],["clean"]]},className:"h-64 mb-4"})}),(0,v.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Verwenden Sie ","{name}"," als Platzhalter f\xfcr den Namen des Empf\xe4ngers."]})]}),(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Anh\xe4nge"}),(0,v.jsxs)("div",{className:"flex items-center mb-2",children:[(0,v.jsx)("input",{type:"file",ref:ej,onChange:function(e){var t=e.target.files;if(t&&0!==t.length){var n=eg.reduce(function(e,t){return e+t.size},0);Array.from(t).forEach(function(e){if(e.size>5242880){alert("Die Datei ".concat(e.name," ist zu gro\xdf (max. 5MB pro Datei)."));return}if((n+=e.size)>10485760){alert("Die Gesamtgr\xf6\xdfe aller Anh\xe4nge \xfcberschreitet 10MB.");return}var t=new FileReader;t.onload=function(t){var n,a=(null===(n=t.target)||void 0===n?void 0:n.result).split(",")[1];eb(function(t){return[].concat((0,r.Z)(t),[{id:"attachment-".concat(Date.now(),"-").concat(e.name),filename:e.name,content:a,contentType:e.type,size:e.size}])})},t.readAsDataURL(e)}),ej.current&&(ej.current.value="")}},className:"hidden",multiple:!0}),(0,v.jsxs)("button",{type:"button",onClick:function(){var e;return null===(e=ej.current)||void 0===e?void 0:e.click()},className:"px-3 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors flex items-center text-sm",children:[(0,v.jsx)(g.UH,{className:"mr-2"}),"Datei anh\xe4ngen"]}),(0,v.jsx)("span",{className:"ml-3 text-xs text-gray-500",children:"Max. 5MB pro Datei, 10MB insgesamt"})]}),eg.length>0&&(0,v.jsx)("div",{className:"mt-2 border rounded-md p-2",children:(0,v.jsx)("ul",{className:"divide-y divide-gray-200",children:eg.map(function(e){return(0,v.jsxs)("li",{className:"py-2 flex justify-between items-center",children:[(0,v.jsxs)("div",{className:"flex items-center",children:[(0,v.jsx)(g.UH,{className:"text-gray-400 mr-2"}),(0,v.jsx)("span",{className:"text-sm",children:e.filename}),(0,v.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",Math.round(e.size/1024)," KB)"]})]}),(0,v.jsx)("button",{onClick:function(){return eS(e.id)},className:"text-red-500 hover:text-red-700",children:(0,v.jsx)(g.Ybf,{})})]},e.id)})})})]}),(0,v.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,v.jsxs)("button",{onClick:eF,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[(0,v.jsx)(g.LbG,{className:"mr-2"}),"Test-E-Mail senden"]}),(0,v.jsx)("button",{onClick:eC,disabled:X||0===z.length,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center ".concat(X||0===z.length?"opacity-70 cursor-not-allowed":""),children:X?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.Bw1,{className:"animate-spin mr-2"}),"Wird gesendet..."]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.LbG,{className:"mr-2"}),"An ",z.length," Empf\xe4nger senden"]})})]})]})}),(0,v.jsx)("div",{className:"lg:col-span-1",children:(0,v.jsxs)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6 mb-6",children:[(0,v.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Empf\xe4nger ausw\xe4hlen"}),(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nach Tag filtern"}),(0,v.jsxs)(j.Z,{placeholder:"Tag ausw\xe4hlen",value:eu,onChange:ew,style:{width:"100%"},allowClear:!0,children:[(0,v.jsx)(j.Z.Option,{value:"none",children:"Keine Tags"}),ex?(0,v.jsx)(j.Z.Option,{value:"",disabled:!0,children:"Tags werden geladen..."}):0===ec.length?(0,v.jsx)(j.Z.Option,{value:"",disabled:!0,children:"Keine Tags verf\xfcgbar"}):ec.map(function(e){return(0,v.jsxs)(j.Z.Option,{value:e.id,children:[e.name," (",e.userCount,")"]},e.id)})]})]}),(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("label",{htmlFor:"group",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kundengruppe"}),(0,v.jsxs)("select",{id:"group",value:en,onChange:function(e){var t=e.target.value;if(er(t),em(""),"all"===t)M(A.map(function(e){return e.id}));else if("new"===t){var n=new Date;n.setDate(n.getDate()-30),M(A.filter(function(e){return new Date(e.created_at)>=n}).map(function(e){return e.id}))}else M([])},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",disabled:!!eu,children:[(0,v.jsx)("option",{value:"",children:"Bitte w\xe4hlen"}),K.map(function(e){return(0,v.jsxs)("option",{value:e.id,children:[e.name," (",e.count,")"]},e.id)})]}),eu&&(0,v.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Bitte deaktivieren Sie zuerst die Tag-Auswahl, um eine Kundengruppe auszuw\xe4hlen."})]}),(0,v.jsxs)("div",{className:"mb-4",children:[(0,v.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kunden suchen"}),(0,v.jsx)("input",{type:"text",id:"search",value:$,onChange:function(e){return ee(e.target.value)},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",placeholder:"E-Mail oder Name"})]}),(0,v.jsxs)("div",{className:"mt-4",children:[(0,v.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,v.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Kunden (",eE.length,")"]}),(0,v.jsxs)("span",{className:"text-sm text-indigo-600",children:[z.length," ausgew\xe4hlt"]})]}),(0,v.jsx)("div",{className:"border rounded-md overflow-y-auto h-64",children:V?(0,v.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-indigo-500"})}):0===eE.length?(0,v.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Keine Kunden gefunden"}):(0,v.jsx)("ul",{className:"divide-y divide-gray-200",children:eE.map(function(e){return(0,v.jsx)("li",{className:"p-3 hover:bg-gray-50",children:(0,v.jsxs)("div",{className:"flex items-center",children:[(0,v.jsx)("input",{type:"checkbox",id:"customer-".concat(e.id),checked:z.includes(e.id),onChange:function(){return ek(e.id)},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,v.jsxs)("label",{htmlFor:"customer-".concat(e.id),className:"ml-3 block",children:[(0,v.jsx)("span",{className:"block text-sm font-medium text-gray-900",children:e.name||"Kein Name"}),(0,v.jsx)("span",{className:"block text-sm text-gray-500",children:e.email})]})]})},e.id)})})}),(0,v.jsxs)("div",{className:"mt-3 flex justify-between",children:[(0,v.jsx)("button",{onClick:function(){return M([])},className:"text-sm text-gray-600 hover:text-gray-900",children:"Auswahl aufheben"}),(0,v.jsx)("button",{onClick:function(){return M(A.map(function(e){return e.id}))},className:"text-sm text-indigo-600 hover:text-indigo-900",children:"Alle ausw\xe4hlen"})]})]})]})})]})]})})]}),(0,v.jsx)(u.Z,{})]})}},44665:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/email-builder",function(){return n(98631)}])},86834:function(){}},function(e){e.O(0,[6130,3365,6058,6405,8428,300,4741,5657,9414,3708,2888,9774,179],function(){return e(e.s=44665)}),_N_E=e.O()}]);